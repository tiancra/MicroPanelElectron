import{_ as A}from"./index.vue_vue_type_script_setup_true_lang-773d6343.js";import{a9 as y,a as G,q as r,B as I,r as d,o as T,c as j,i as a,w as o,y as V,b as p,t as H,F as J,ag as f,_ as L}from"./index-1781b57c.js";const O=s=>y.get("/database/redis/allkeys"+(s?`?sep=${s}`:"")),Q=s=>y.get("/database/redis/getkey?key="+s),W=s=>y.post("/database/redis/setkey",s),X=s=>y.delete("/database/redis/delkey?key="+s),Y=s=>y.delete("/database/redis/delkeys?key="+s),Z={style:{display:"flex",width:"100%"}},ee={class:"custom-tree-node"},te={style:{"margin-left":"auto","font-size":"12px",color:"blue"}},ae=["onClick"],le=["onClick"],se=G({__name:"index",setup(s){const _=r(!1),u=r(""),c=r(),k=r([]),h=r(":"),v=r(""),g=r(),D={children:"children",label:"name"},m=async()=>{let t=await O(h.value);t.code==200&&(k.value=t.data)},$=async t=>{let e=await Q(t);e.code==200?v.value=e.data:v.value="[获取数据失败]:"+e.message},C=async(t,e,n=!0)=>{let i=await W({key:t,value:e});i.code==200?(v.value=i.data,n==!0&&g.value&&g.value.close(),f.success("保存成功！"),m()):f.error("保存失败！")},B=async()=>{var e,n;if(console.log(c.value.data),u.value==""){f.error("键名不为空！");return}if((n=(e=c.value)==null?void 0:e.data)==null?void 0:n.children.some(i=>i.name==u.value)){f.error("该键名已存在！");return}await C(`${c.value.data.path}${c.value.data.path==""?"":":"}${u.value}`,"",!1),_.value=!1,u.value="",m()},E=()=>{c.value={data:{name:"",path:"",children:k.value}},_.value=!0},F=async(t,e=!1)=>{(e?await Y(t):await X(t)).code==200&&(f.success("删除成功！"),m())},P=async t=>{var e;((e=t.children)==null?void 0:e.length)==0&&(await $(t.path),g.value.open({content:v.value,confirm:n=>{C(t.path,n)}}))};return I(()=>{m()}),(t,e)=>{const n=d("el-divider"),i=d("el-input"),b=d("el-button"),R=d("el-form-item"),w=d("el-form"),U=d("el-tree"),M=d("el-card"),S=d("el-dialog");return T(),j(J,null,[a(M,null,{default:o(()=>[a(n,null,{default:o(()=>[...e[3]||(e[3]=[V(" Redis ",-1)])]),_:1}),a(w,null,{default:o(()=>[a(R,{label:"分隔符"},{default:o(()=>[p("div",Z,[a(i,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=l=>h.value=l),size:"small",style:{width:"30px","margin-right":"5px"}},null,8,["modelValue"]),a(b,{icon:"Refresh",size:"small",onClick:m}),a(b,{size:"small",onClick:E,style:{"margin-left":"auto"}},{default:o(()=>[...e[4]||(e[4]=[V("添加",-1)])]),_:1})])]),_:1})]),_:1}),a(U,{data:k.value,props:D,onNodeClick:P},{default:o(({node:l,data:oe})=>[p("span",ee,[p("span",null,H(l.label),1),p("span",te,[p("a",{onClick:x=>(_.value=!0,c.value=l,x.stopPropagation())},"添加",8,ae),p("a",{style:{"margin-left":"8px"},onClick:x=>{var K,q,N,z;return F(((K=l.data)==null?void 0:K.children.length)>0?((q=l.data)==null?void 0:q.path)+"*":(N=l.data)==null?void 0:N.path,((z=l.data)==null?void 0:z.children.length)>0),x.stopPropagation()}},"删除",8,le)])])]),_:1},8,["data"])]),_:1}),a(A,{ref_key:"CodeDialogRef",ref:g},null,512),a(S,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=l=>_.value=l),title:"添加键"},{footer:o(()=>[a(b,{type:"primary",size:"default",onClick:B},{default:o(()=>[...e[5]||(e[5]=[V(" 确认添加 ",-1)])]),_:1})]),default:o(()=>[a(w,null,{default:o(()=>[a(R,{label:"输入键名"},{default:o(()=>[a(i,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=l=>u.value=l),"input-style":{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});const ie=L(se,[["__scopeId","data-v-5957d98b"]]);export{ie as default};
