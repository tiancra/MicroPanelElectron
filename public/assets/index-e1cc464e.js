import{g as T,h as Y}from"./index-0c0d10c8.js";import{a as G,q as v,B as H,r as n,o as d,c as b,i as t,w as u,b as f,y as x,t as V,F as w,g as N,h as g,e as h,u as K,x as Q,ag as m,_ as W}from"./index-1781b57c.js";const X={class:"top_bar"},Z={style:{"font-size":"12px"}},ee={class:"sub-title"},le={key:3},te=G({__name:"index",setup(ae){const S=v([{route:"Status",title:"状态"},{route:"Logs",title:"日志"},{route:"Fs",title:"文件"},{route:"Plugin",title:"开发"},{route:"Bot",title:"Bot配置"},{route:"Protocol",title:"协议配置"},{route:"Plugins",title:"其它配置"},{route:"Permission",title:"权限管理"},{route:"About",title:"关于"}]);let i=v(!1);const r=v([]),U=v(0),k=v("add"),a=v({}),C=async()=>{let l=await T();l.code==200&&(r.value=l.data)},L=()=>{k.value="add";const l=JSON.parse(JSON.stringify(r.value[0]));l.username.value="",l.password.value="",l.avatar.value="",l.expires.value="86400s",a.value=l,i.value=!0},P=(l,o)=>{k.value="update",a.value=l,U.value=o,i.value=!0},q=(l,o)=>{const p=new Set;for(let c=0;c<l.length;c++){const y=l[c][o].value;if(p.has(y))return!0;p.add(y)}return!1},A=async()=>{let l=await Y(r.value);console.log(l),l.code==200&&(m.success("保存成功！"),C(),i.value=!1)},z=l=>{if(r.value.length<=1){m.error("不可清空！");return}r.value.splice(l,1),console.log(r.value),A()},D=()=>{if(k.value=="add"){if(!a.value.password.value){m.error("密码不能为空！");return}if(a.value.password.value.length<5||a.value.password.value.length>20){m.error("密码长度5-20位！");return}if(a.value.username.value.length<2||a.value.username.value.length>20){m.error("账号长度2-20位！");return}if(r.value.push(a.value),q(r.value,"username")){m.error("已存在相同账号！"),C();return}}else r.value[U.value]=a.value;i.value=!1,A()};return H(()=>{C()}),(l,o)=>{const p=n("el-button"),c=n("el-table-column"),y=n("el-popconfirm"),E=n("el-table"),F=n("el-card"),M=n("el-input"),O=n("el-input-number"),I=n("el-switch"),J=n("el-checkbox"),$=n("el-checkbox-group"),j=n("el-form-item"),R=n("el-dialog");return d(),b(w,null,[t(F,null,{default:u(()=>[f("div",X,[o[2]||(o[2]=f("div",{class:"sub-title"},"用户权限",-1)),f("div",null,[t(p,{type:"primary",icon:"Plus",onClick:L},{default:u(()=>[...o[1]||(o[1]=[x(" 添加 ",-1)])]),_:1})])]),t(E,{data:r.value},{default:u(()=>[t(c,{type:"index",label:"#"}),t(c,{label:"账号"},{default:u(({row:e,$index:_})=>[x(V(e.username.value),1)]),_:1}),t(c,{label:"描述"},{default:u(({row:e,$index:_})=>[f("span",Z,V(e.desc.value),1)]),_:1}),t(c,{label:"操作",fixed:"right","min-width":"120px"},{default:u(({row:e,$index:_})=>[t(p,{type:"primary",size:"small",icon:"Edit",onClick:B=>P(e,_)},null,8,["onClick"]),t(y,{title:"删除后不可恢复，您确定吗？",onConfirm:B=>z(_)},{reference:u(()=>[t(p,{type:"primary",size:"small",icon:"Delete"})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1}),t(R,{modelValue:K(i),"onUpdate:modelValue":o[0]||(o[0]=e=>Q(i)?i.value=e:i=e),title:a.value.desc?a.value.desc.value:"新增管理员"},{default:u(()=>[t(p,{type:"primary",onClick:D},{default:u(()=>[...o[3]||(o[3]=[x(" 保存 ",-1)])]),_:1}),(d(!0),b(w,null,N(a.value,(e,_,B)=>(d(),g(j,{key:_,lable:e.desc},{default:u(()=>[f("div",ee,V(e.desc),1),e.type=="string"?(d(),g(M,{key:0,modelValue:e.value,"onUpdate:modelValue":s=>e.value=s},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),e.type=="number"?(d(),g(O,{key:1,modelValue:e.value,"onUpdate:modelValue":s=>e.value=s},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),e.type=="boolean"?(d(),g(I,{key:2,modelValue:e.value,"onUpdate:modelValue":s=>e.value=s,class:"ml-2","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66"},"active-text":"Y","inactive-text":"N"},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),e.type=="array"?(d(),b("div",le,[t($,{modelValue:e.value,"onUpdate:modelValue":s=>e.value=s},{default:u(()=>[(d(!0),b(w,null,N(S.value,s=>(d(),g(J,{key:s.route,value:s.route},{default:u(()=>[x(V(s.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])])):h("",!0)]),_:2},1032,["lable"]))),128))]),_:1},8,["modelValue","title"])],64)}}});const ue=W(te,[["__scopeId","data-v-54d561a2"]]);export{ue as default};
